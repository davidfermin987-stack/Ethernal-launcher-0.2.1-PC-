<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ethernal Client 0.1</title>
  <link rel="icon" href="ðŸ”¥" />
  <script src="https://alcdn.msauth.net/browser/2.37.0/js/msal-browser.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: url('fondo_default.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Segoe UI', sans-serif;
      color: white;
      text-align: center;
      overflow: hidden;
      transition: background 1s ease-in-out;
    }

    .fade {
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }

    .fade.show {
      opacity: 1;
    }

    #logo {
      width: 350px;
      margin-top: 40px;
      filter: drop-shadow(0 0 25px rgba(255, 255, 255, 0.5));
      transition: opacity 1s ease-in-out;
    }

    #event-logo {
      display: none;
      width: 400px;
      margin: 80px auto 20px;
      transition: opacity 1s ease-in-out;
    }

    .event-panel {
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      width: 120px;
      background: rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(6px);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      padding-top: 30px;
      box-shadow: 2px 0 10px rgba(0,0,0,0.4);
    }

    .event-selector {
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    .event-icon {
      width: 80px;
      height: 80px;
      background-color: rgba(0, 0, 0, 0.3);
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .event-icon:hover,
    .event-icon.active {
      background-color: rgba(0, 0, 0, 0.6);
      border: 2px solid #00bfff;
      transform: scale(1.1);
    }

    #playButton {
      background-color: rgba(0, 0, 60, 0.7);
      border: none;
      padding: 15px 90px;
      font-size: 22px;
      color: white;
      border-radius: 15px;
      cursor: pointer;
      margin-top: 40px;
      transition: all 0.3s ease;
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
    }

    #playButton:hover {
      background-color: rgba(0, 0, 90, 0.8);
      transform: translateX(-50%) scale(1.05);
    }

    #userIcon {
      position: fixed;
      bottom: 20px;
      left: 25px;
      width: 70px;
      height: 70px;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid #00bfff;
    }

    #userIcon:hover {
      transform: scale(1.1);
      border-color: white;
    }

    #adminPanel {
      position: fixed;
      top: 0;
      right: 0;
      height: 100vh;
      width: 220px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(6px);
      padding: 20px;
      box-shadow: -2px 0 10px rgba(0, 0, 0, 0.4);
      display: none;
      flex-direction: column;
      color: white;
      text-align: left;
    }

    #adminPanel h3 {
      text-align: center;
      margin-bottom: 20px;
    }

    .toggle {
      display: flex;
      justify-content: space-between;
      margin: 10px 0;
      background: rgba(255, 255, 255, 0.1);
      padding: 8px;
      border-radius: 10px;
    }

    .toggle button {
      background: rgba(0, 0, 100, 0.6);
      border: none;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      padding: 5px 10px;
      transition: all 0.3s ease;
    }

    .toggle button:hover {
      background: rgba(0, 0, 150, 0.8);
    }
  </style>
</head>
<body>
  <img id="logo" src="logo_principal.png" alt="Ethernal Client" />
  <img id="event-logo" src="" alt="Evento" />

  <div class="event-panel">
    <div class="event-selector">
      <!-- ðŸ”¹ Los eventos iniciales se ocultarÃ¡n dinÃ¡micamente -->
    </div>
    <button id="addInstance" class="event-icon" style="font-size:28px; font-weight:bold;">+</button>
  </div>

  <button id="playButton">JUGAR</button>
  <img id="userIcon" src="usuario.png" alt="Usuario" />

  <div id="adminPanel">
    <h3>Panel Admin</h3>
    <div class="toggle">
      <span>Pesadilla</span>
      <button id="togglePesadilla">ON</button>
    </div>
    <div class="toggle">
      <span>Build</span>
      <button id="toggleBuild">ON</button>
    </div>
    <div class="toggle">
      <span>InfecciÃ³n</span>
      <button id="toggleInfeccion">ON</button>
    </div>
  </div>

  <!-- Panel de instancias -->
  <div id="instancePanel" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; backdrop-filter:blur(8px); background:rgba(0,0,0,0.6); justify-content:center; align-items:center; flex-direction:column; color:white;">
    <div style="background:rgba(20,20,20,0.8); border-radius:15px; padding:40px; width:70%; max-width:700px; position:relative; text-align:center;">
      <button id="closeInstance" style="position:absolute; top:15px; right:20px; background:none; border:none; color:white; font-size:28px; cursor:pointer;">âœ–</button>
      <h2>Instancias</h2>
      <p style="opacity:0.8;">No hay instancias disponibles</p>
      <div class="instance-gallery" style="display:flex; gap:30px; justify-content:center; margin-top:30px;">
        <div class="instance-card" data-name="Pesadilla Hardcore" data-img="pesadilla.png" style="background:rgba(255,255,255,0.1); border-radius:10px; padding:10px; cursor:pointer;">
          <img src="pesadilla.png" style="width:100px; height:100px; border-radius:10px;">
          <p>Pesadilla Hardcore</p>
        </div>
        <div class="instance-card" data-name="Build Ethernal Battle" data-img="build.png" style="background:rgba(255,255,255,0.1); border-radius:10px; padding:10px; cursor:pointer;">
          <img src="build.png" style="width:100px; height:100px; border-radius:10px;">
          <p>Build Ethernal Battle</p>
        </div>
        <div class="instance-card" data-name="InfecciÃ³n Hardcore" data-img="infeccion.png" style="background:rgba(255,255,255,0.1); border-radius:10px; padding:10px; cursor:pointer;">
          <img src="infeccion.png" style="width:100px; height:100px; border-radius:10px;">
          <p>InfecciÃ³n Hardcore</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Panel de confirmaciÃ³n -->
  <div id="confirmPanel" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; backdrop-filter:blur(8px); background:rgba(0,0,0,0.7); justify-content:center; align-items:center; flex-direction:column; color:white;">
    <div style="background:rgba(20,20,20,0.85); border-radius:15px; padding:40px; width:400px; text-align:center;">
      <h3>Â¿AÃ±adir esta instancia al panel de eventos?</h3>
      <div style="display:flex; justify-content:center; gap:20px; margin-top:30px;">
        <button id="acceptAdd" style="background:green; border:none; color:white; padding:10px 20px; border-radius:10px; cursor:pointer;">Aceptar</button>
        <button id="cancelAdd" style="background:gray; border:none; color:white; padding:10px 20px; border-radius:10px; cursor:pointer;">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- ðŸ”¹ Script principal -->
  <script>
    // Tu cÃ³digo original completo aquÃ­ (no modificado)...
  </script>

  <!-- ðŸ”¹ Script de gestiÃ³n de instancias (aÃ±adido) -->
  <script>
    const instancePanel = document.getElementById("instancePanel");
    const confirmPanel = document.getElementById("confirmPanel");
    const addButton = document.getElementById("addInstance");
    const closeButton = document.getElementById("closeInstance");
    const cancelAdd = document.getElementById("cancelAdd");
    const acceptAdd = document.getElementById("acceptAdd");
    let selectedInstance = null;

    window.addEventListener("DOMContentLoaded", () => {
      const savedInstances = JSON.parse(localStorage.getItem("userInstances")) || [];
      savedInstances.forEach(inst => addInstanceToPanel(inst.name, inst.img, false));
    });

    addButton.addEventListener("click", () => {
      instancePanel.style.display = "flex";
    });

    closeButton.addEventListener("click", () => {
      instancePanel.style.display = "none";
    });

    document.querySelectorAll(".instance-card").forEach(card => {
      card.addEventListener("click", () => {
        selectedInstance = {
          name: card.getAttribute("data-name"),
          img: card.getAttribute("data-img")
        };
        confirmPanel.style.display = "flex";
        instancePanel.style.display = "none";
      });
    });

    cancelAdd.addEventListener("click", () => {
      confirmPanel.style.display = "none";
      instancePanel.style.display = "flex";
    });

    acceptAdd.addEventListener("click", () => {
      confirmPanel.style.display = "none";
      if (selectedInstance) {
        addInstanceToPanel(selectedInstance.name, selectedInstance.img, true);
        const savedInstances = JSON.parse(localStorage.getItem("userInstances")) || [];
        savedInstances.push(selectedInstance);
        localStorage.setItem("userInstances", JSON.stringify(savedInstances));
      }
    });

    function addInstanceToPanel(name, imgSrc, save = true) {
      const existingIcons = Array.from(document.querySelectorAll(".event-icon"))
        .map(icon => icon.alt.toLowerCase());
      if (existingIcons.includes(name.toLowerCase())) return;

      const container = document.createElement("div");
      container.style.position = "relative";
      container.style.width = "80px";
      container.style.height = "80px";
      container.style.marginBottom = "20px";
      container.classList.add("custom-instance");

      const newIcon = document.createElement("img");
      newIcon.src = imgSrc;
      newIcon.alt = name;
      newIcon.className = "event-icon";
      newIcon.title = name;

      const deleteBtn = document.createElement("button");
      deleteBtn.textContent = "ðŸ—‘";
      deleteBtn.style.position = "absolute";
      deleteBtn.style.top = "-10px";
      deleteBtn.style.right = "-10px";
      deleteBtn.style.background = "rgba(0,0,0,0.6)";
      deleteBtn.style.border = "none";
      deleteBtn.style.color = "white";
      deleteBtn.style.borderRadius = "50%";
      deleteBtn.style.cursor = "pointer";
      deleteBtn.style.fontSize = "14px";
      deleteBtn.style.padding = "3px 5px";
      deleteBtn.style.display = "none";
      deleteBtn.style.transition = "opacity 0.3s ease";

      container.addEventListener("mouseenter", () => (deleteBtn.style.display = "block"));
      container.addEventListener("mouseleave", () => (deleteBtn.style.display = "none"));

      deleteBtn.addEventListener("click", e => {
        e.stopPropagation();
        container.remove();
        const savedInstances = JSON.parse(localStorage.getItem("userInstances")) || [];
        const updated = savedInstances.filter(inst => inst.name !== name);
        localStorage.setItem("userInstances", JSON.stringify(updated));
      });

      const addBtn = document.getElementById("addInstance");
      addBtn.parentNode.insertBefore(container, addBtn);

      container.appendChild(newIcon);
      container.appendChild(deleteBtn);

      newIcon.addEventListener("click", () => {
        alert(`Evento "${name}" seleccionado âœ…`);
      });

      if (save) {
        const savedInstances = JSON.parse(localStorage.getItem("userInstances")) || [];
        savedInstances.push({ name, img: imgSrc });
        localStorage.setItem("userInstances", JSON.stringify(savedInstances));
      }
    }
  </script>
</body>
</html>
