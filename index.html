<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ethernal Client 0.1</title>
  <link rel="icon" href="üî•" />
  <script src="https://alcdn.msauth.net/browser/2.37.0/js/msal-browser.min.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: url('fondo-ethernal.jpg') no-repeat center center/cover;
      color: white;
      text-align: center;
      height: 100vh;
      margin: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: background-image 0.8s ease-in-out;
      overflow: hidden;
    }

    .sidebar {
      position: absolute;
      left: 20px;
      top: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    .sidebar img {
      width: 70px;
      height: 70px;
      cursor: pointer;
      border-radius: 50%;
      transition: transform 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease, border 0.3s ease;
      object-fit: cover;
      border: 2px solid transparent;
    }

    .sidebar img:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px white;
    }

    /* ‚ú® Selecci√≥n de evento ‚ú® */
    .sidebar img.seleccionado {
      filter: brightness(0.8);
      border: 2px solid rgba(255, 255, 255, 0.9);
      box-shadow: 0 0 12px rgba(255, 255, 255, 0.6);
    }

    #logoEvento {
      width: 360px;
      margin-bottom: 60px;
      filter: drop-shadow(0 0 8px rgba(255,255,255,0.7));
      transition: opacity 0.8s ease-in-out, transform 0.3s ease;
    }

    h1 {
      font-size: 2em;
      color: #fff;
      text-shadow: 0 0 10px #ffffff;
    }

    button {
      position: fixed;
      bottom: 100px;
      padding: 18px 80px;
      border: none;
      border-radius: 15px;
      background: rgba(0, 0, 50, 0.6);
      color: white;
      font-size: 1.3em;
      cursor: pointer;
      transition: background 0.3s ease, transform 0.2s ease;
      backdrop-filter: blur(5px);
    }

    button:hover {
      background: rgba(0, 0, 70, 0.9);
      transform: scale(1.05);
    }

    .fade {
      opacity: 0;
      transition: opacity 0.8s ease;
    }

    .fade.show {
      opacity: 1;
    }
  </style>
</head>
<body class="fade show">
  <div class="sidebar">
    <img src="pesadilla.png" alt="Pesadilla Hardcore" id="btnPesadilla" onclick="cambiarEvento('pesadilla', this)">
    <img src="build.png" alt="Build Ethernal Battle" id="btnBuild" onclick="cambiarEvento('build', this)">
    <img src="infeccion.png" alt="Infecci√≥n Hardcore" id="btnInfeccion" onclick="cambiarEvento('infeccion', this)">
    <img src="usuario.png" alt="Usuario" id="usuarioIcono" onclick="iniciarSesion()">
  </div>

  <img id="logoEvento" class="fade show" src="logo-ethernal.png" alt="Logo principal">
  <h1 id="titulo">Ethernal Client 0.1</h1>
  <button id="playButton" onclick="entrarServidor()">JUGAR</button>

  <script>
    let eventoActual = null;
    let sesionIniciada = false;

    const msalConfig = {
      auth: {
        clientId: "d74436bb-7b1f-4b71-ae9b-0ee145ad2b44",
        authority: "https://login.microsoftonline.com/consumers",
        redirectUri: window.location.origin
      }
    };

    const msalInstance = new msal.PublicClientApplication(msalConfig);

    async function iniciarSesion() {
      try {
        const loginResponse = await msalInstance.loginPopup({
          scopes: ["user.read"]
        });

        if (loginResponse) {
          sesionIniciada = true;
          const account = loginResponse.account;

          const tokenResponse = await msalInstance.acquireTokenSilent({
            scopes: ["user.read"],
            account: account
          });

          const profile = await fetch("https://graph.microsoft.com/v1.0/me/photo/$value", {
            headers: { Authorization: `Bearer ${tokenResponse.accessToken}` }
          });

          if (profile.ok) {
            const blob = await profile.blob();
            const imageUrl = URL.createObjectURL(blob);
            document.getElementById("usuarioIcono").src = imageUrl;
          } else {
            document.getElementById("usuarioIcono").src = "usuario.png";
          }

          alert(`‚úÖ Sesi√≥n iniciada: ${account.username}`);
        }
      } catch (err) {
        console.error("Error en inicio de sesi√≥n:", err);
        alert("‚ùå No se pudo iniciar sesi√≥n con Microsoft.");
      }
    }

    function cambiarEvento(evento, elemento) {
      eventoActual = evento;

      document.querySelectorAll('.sidebar img').forEach(img => img.classList.remove('seleccionado'));
      elemento.classList.add('seleccionado');

      const fondo = document.body;
      const logoEvento = document.getElementById('logoEvento');
      const titulo = document.getElementById('titulo');

      fondo.classList.remove('show');
      logoEvento.classList.remove('show');
      titulo.classList.remove('show');

      setTimeout(() => {
        if (evento === 'pesadilla') {
          fondo.style.backgroundImage = "url('fondo-pesadilla.jpg')";
          logoEvento.src = "pesadilla-logo.png";
        } else if (evento === 'build') {
          fondo.style.backgroundImage = "url('fondo-build.jpg')";
          logoEvento.src = "build-logo.png";
        } else if (evento === 'infeccion') {
          fondo.style.backgroundImage = "url('fondo-infeccion.jpg')";
          logoEvento.src = "infeccion-logo.png";
        }

        titulo.textContent = "";
        setTimeout(() => {
          fondo.classList.add('show');
          logoEvento.classList.add('show');
        }, 100);
      }, 300);
    }

    function entrarServidor() {
      if (!sesionIniciada) {
        alert("‚ö†Ô∏è Debes iniciar sesi√≥n con tu cuenta Microsoft antes de jugar.");
        return;
      }

      if (!eventoActual) {
        alert("‚ö†Ô∏è Primero selecciona un evento antes de jugar.");
        return;
      }

      let enlace = "";

      // ‚úÖ Todos apuntan al mismo link, pero el c√≥digo est√° preparado si despu√©s cambias alguno
      if (eventoActual === "pesadilla") {
        enlace = "minecraft://connect/?serverUrl=na81.aternos.me&serverPort=60240";
      } else if (eventoActual === "build") {
        enlace = "minecraft://connect/?serverUrl=na81.aternos.me&serverPort=60240";
      } else if (eventoActual === "infeccion") {
        enlace = "minecraft://connect/?serverUrl=na81.aternos.me&serverPort=60240";
      }

      window.location.href = enlace;
    }

    window.onload = () => {
      document.body.classList.add('fade', 'show');
      document.getElementById('logoEvento').classList.add('fade', 'show');
    };
  </script>
</body>
</html>
